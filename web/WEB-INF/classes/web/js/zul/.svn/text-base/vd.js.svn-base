zk.load("zul.zul");if(!window.Validate_errorbox){window.Validate_errorbox=function(E,C,D){var A=null;if(zk.ie6Only){A="/web/zul/img/vd/arrowU.gif"}else{A="/web/zul/img/vd/arrowU.png"}var B='<div onmousedown="zkVld._ebmdown()" onmouseup="zkVld._ebmup()" id="'+C+'" style="display:none;position:absolute" class="z-errbox"><div><table width="250" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="17"><img src="'+zk.getUpdateURI(A)+'" id="'+E+'!img" onclick="zkVld._eblocate(this)" title="'+mesg.GOTO_ERROR_FIELD+'"/></td><td>'+zk.encodeXML(D,true)+'</td><td width="16"><img src="'+zk.getUpdateURI("/web/zul/img/vd/close-off.gif")+'" onclick="zkVld._ebclose(this)" onmouseover="zkau.onimgover(this)" onmouseout="zkau.onimgout(this)"/></td></tr></table></div></div>';document.body.insertAdjacentHTML("afterbegin",B);return $e(C)}}zkVld={};zkVld._ebs=[];zkVld._cbs=[];zkau.valid=zkVld;zkVld.onScrollAt=function(F){for(var C=zkVld._ebs,A=C.length;--A>=0;){var E=$e(C[A]),B=$outer(E);for(var D=B;D;D=$parent(D)){if(!$visible(D)){break}if(!F||D==F){zkVld.syncErrBox(E,true);break}}}};zkVld.syncErrBox=function(E,H){var D=$outer(E),G=zk.revisedOffset(D),B=D.offsetWidth,A=D.offsetHeight,F;if(!H&&zkau.currentFocus&&zkau.currentFocus!=D){var C=zk.revisedOffset(zkau.currentFocus);if(C[0]<G[0]+B&&G[0]+B+220<zk.innerX()+zk.innerWidth()){G[0]+=B+2}else{if(C[1]<G[1]&&G[1]+A+50<zk.innerY()+zk.innerHeight()){G[1]+=A+2}else{F=true}}}else{G[0]+=B+2}E.style.display="block";if(F){G[1]-=E.offsetHeight+1}G=zk.toStyleOffset(E,G[0],G[1]);E.style.left=G[0]+"px";E.style.top=G[1]+"px"};zkVld.validate=function(id){id=$uuid(id);var cm=$e(id);if(getZKAttr(cm,"srvald")=="custom"){return }zkVld.validating=true;try{if(cm){var ermg=getZKAttr(cm,"ermg");var fn=getZKAttr(cm,"valid");if(fn){var msg=fn.indexOf("(")<0?zk.resolve(fn).call(cm,id):eval(fn);if(msg){return ermg?ermg:msg}}fn=getZKAttr(cm,"valid2");if(fn){var msg=fn.indexOf("(")<0?zk.resolve(fn).call(cm,id):eval(fn);if(msg){return ermg?ermg:msg}}var msg=zk.eval(cm,"validate");if(msg){return ermg?ermg:msg}}var meta=zkau.getMeta(id);if(meta&&meta.validate){var msg=meta.validate();if(msg){return ermg?ermg:msg}}zkVld.validating=false;return null}catch(ex){zkVld.validating=false;throw ex}};zkVld.onlyInt=zkVld.onlyLong=function(A){return zkVld.onlyNum(A,true)};zkVld.onlyNum=function(B,K){var M=$e(B);if(!M){return null}var E=$outer(M);if(E){E=getZKAttr(E,"fmt")}M=$real(M);var A,C,I,J,L,D=M.value.trim();for(var H=0,G=D.length;H<G;++H){var F=D.charAt(H);if(F>="0"&&F<="9"){C=true;continue}switch(F){case"+":case zk.MINUS:if(A||C||I||J||L){break}I=true;continue;case zk.DECIMAL:if(A||J){break}A=F==zk.DECIMAL;if(A&&K){return mesg.INTEGER_REQUIRED+D}continue;case zk.PERCENT:J=true;case zk.GROUPING:L=true;case" ":case"\t":continue;default:if(E&&E.indexOf(F)>=0){continue}}return mesg.NUMBER_REQUIRED+D}if(!C&&(A||I||J||L)){return mesg.NUMBER_REQUIRED+D}return null};zkVld.noEmpty=function(B){var A=$real($e(B));return A&&!A.value.trim()?mesg.EMPTY_NOT_ALLOWED:null};zkVld.noEmptyAndStrict=function(B){var A=zkVld.noEmpty(B);if(A){return A}return zkVld.strict(B)};zkVld.strict=function(A){if(window.zkCmbox){return window.zkCmbox.strict(A)}return null};zkVld.errbox=function(C,A){C=$uuid(C);var B=$e(C);if(B&&zk.isRealVisible(B,true)){zkVld._errInfo={id:C,html:A};setTimeout(zkVld._errbox,5)}zkVld.validating=false};zkVld._errbox=function(){if(!zkVld._errInfo){return }var D=zkVld._errInfo.id,A=zkVld._errInfo.html;zkVld._errInfo=null;var B=D+"!errb";zkVld.closeErrbox(B);if(zkVld._cbs.contains(B)){return }cmp=$e(D);if(cmp){zk.addClass($real(cmp),getZKAttr(cmp,"zcls")+"-text-invalid")}if(!zk.isRealVisible(cmp,true)){return }if(getZKAttr(cmp,"srvald")=="custom"){return }var C=Validate_errorbox(D,B,A);if(!C){zk.alert(A);return }zkVld._ebs.push(B);if(!zkVld._cnt){zkVld._cnt=0}C.style.zIndex=$int(Element.getStyle(C,"z-index"))+(++zkVld._cnt);if(cmp){zkVld.syncErrBox(C)}else{C.style.display="block";zk.center(C)}zkVld._fiximg(C);zkVld.uncover();if(!zk.opera){anima.slideDown(C,{duration:0.5})}if(zk.ie6Only){setTimeout(function(){C._ifr=zk.createLining(C,D)},0)}zul.initMovable(C,{zindex:C.style.zIndex,effecting:zkVld._fiximg,starteffect:zk.voidf,endeffect:zkVld._fiximg,change:zkVld._change})};zkVld._change=zk.ie6Only?function(B,C,A){if(B.element._ifr){B.element._ifr.style.top=B.element.style.top;B.element._ifr.style.left=B.element.style.left}}:zk.voidf;zkVld.closeErrbox=function(E,D,B){var A,F;if(typeof E=="string"){F=$uuid(E);A=F+"!errb";E=$e(A)}else{if(E){A=E.id;F=$uuid(A)}}if(!D){var C=$e(F);if(C){zk.rmClass($real(C),getZKAttr(C,"zcls")+"-text-invalid")}}if(E){zul.cleanMovable(E.id);if(zk.ie6Only){if(E._ifr){E._ifr.parentNode.removeChild(E._ifr)}E._ifr=null}E.parentNode.removeChild(E);zkVld._ebs.remove(E.id)}else{if(A){if(B){zkVld._cbs.push(A);setTimeout(function(){zkVld._cbs.remove(A);zkVld._ebs.remove(A)},5)}else{zkVld._ebs.remove(A)}}}};zkVld._ebclose=function(A){for(;A;A=A.parentNode){if(A.id&&A.id.endsWith("!errb")){var B=A.id.substring(0,A.id.length-5);zkVld.closeErrbox(B,true);return }}};zkVld._eblocate=function(A){for(;A;A=A.parentNode){if(A.id&&A.id.endsWith("!errb")){var B=A.id.substring(0,A.id.length-5);zkVld.focus($e(B));return }}};zkVld.focus=function(A){if(A){try{if(A.select){A.select()}if(A.focus){A.focus()}}catch(B){}}};zkVld._ebmdown=function(){zkVld.validating=true};zkVld._ebmup=function(){zkVld.validating=false};zkVld._fiximg=function(E){var A=$uuid(E.id);var F=$e(A);var D=$e(A+"!img");if(F&&D){var C=zk.revisedOffset(F);var G=zk.revisedOffset(E);var I=G[0]-C[0],H=G[1]-C[1],B;if(I>F.offsetWidth){B=H<-10?"LD":H>F.offsetHeight+10?"LU":"L"}else{if(I<0){B=H<-10?"RD":H>F.offsetHeight+10?"RU":"R"}else{B=H<0?"D":"U"}}if(zk.ie6Only){D.src=zk.getUpdateURI("/web/zul/img/vd/arrow"+B+".gif")}else{D.src=zk.getUpdateURI("/web/zul/img/vd/arrow"+B+".png")}}};zkVld.uncover=function(A){var E=zk.coveredTagnames;for(var G=zkVld._ebs.length;--G>=0;){var I=zkVld._ebs[G];var H=$e(I);if(!H){zkVld._ebs.splice(G,1);continue}if(A){zkVld._uncover(H,A)}else{if(!E.length){return }}for(var F=0,J=E.length;F<J;++F){var D=document.getElementsByTagName(E[F]);for(var C=0,B=D.length;C<B;C++){if(zk.shallHideDisabled(D[C])&&zk.isRealVisible(D[C],true)){zkVld._uncover(H,D[C],true)}}}}};zkVld._uncover=function(G,C,D){var I=zPos.cumulativeOffset(C);var N=zPos.cumulativeOffset(G);if(zk.isOffsetOverlapped(I,[C.offsetWidth,C.offsetHeight],N,[G.offsetWidth,G.offsetHeight])){var L=$e(G.id.substring(0,G.id.length-5));var K;if(L){var E=zPos.cumulativeOffset(L),P=L.offsetHeight;if(D){var M=I[1]+C.offsetHeight,F=G.offsetHeight;K=E[1];if(M>K+P||M+F<K){var J=I[1]-F;if(J>K+P||J+F<K){var B=M>K?M-K-P:K-M-F;var A=J>K?J-K-P:K-J-F;K=B<=A?M:J}else{K=J}}else{K=M}}else{var O=E[1]+P;K=I[1]+C.offsetHeight<=O?O:E[1]-G.offsetHeight}}else{K=N[1]>I[1]?I[1]+C.offsetHeight:I[1]-G.offsetHeight}var H=zk.toStyleOffset(G,0,K);G.style.top=H[1]+"px";zkVld._fiximg(G)}};zkVld.fixerrboxes=function(){for(var A=zkVld._ebs.length;--A>=0;){var B=zkVld._ebs[A];var D=$e(B);if(D){var E=B.substring(0,B.length-5);var C=$e(E);if(!C){zkVld.closeErrbox(D)}}else{zkVld._ebs.splice(A,1)}}};zkVld.addHideCovered=function(B){for(var A=zkVld._ebs.length;--A>=0;){var C=$e(zkVld._ebs[A]);if(C){B.push(C)}}};zkTxbox={};zkau.textbox=zkTxbox;zkTxbox._intervals={};_zktbau={setAttr:zkau.setAttr};zkau.setAttr=function(E,A,G){if("disabled"==A||"readOnly"==A){var D=$real(E),C=D.type?D.type.toUpperCase():"";if(C=="TEXT"||C=="TEXTAREA"){var B=$outer(E),F=getZKAttr(B,"zcls");if("disabled"==A){zk[G=="true"?"addClass":"rmClass"](B,F+"-disd")}zk[G=="true"?"addClass":"rmClass"](D,"disabled"==A?F+"-text-disd":F+"-readonly")}}return _zktbau.setAttr(E,A,G)};zkTxbox.init=function(D,F,G){zk.listen(D,"focus",F?F:zkTxbox.onfocus);zk.listen(D,"blur",G?G:zkTxbox.onblur);zk.listen(D,"select",zkTxbox.onselect);if($tag(D)=="TEXTAREA"){zk.listen(D,"keyup",zkTxbox.onkey)}zk.listen(D,"keydown",zkTxbox.onkeydown);var A=getZKAttr($outer(D),"srvald");if(A&&A!="fmt"){var B=D.value;D.defaultValue=B+"-";if(B!=D.value){D.value=B}}var C=$outer(D),E=getZKAttr(C,"zcls");if(D.readOnly){zk.addClass(D,E+"-readonly")}if(D.disabled){zk.addClass(D,E+"-text-disd");zk.addClass(C,E+"-disd")}};zkTxbox.cleanup=zkTxbox.onHide=function(B){var A=$real(B);if(A){zkVld.closeErrbox(A.id,true)}};zkTxbox.onselect=function(A){var D=zkau.evtel(A);var C=$outer(D);if(zkau.asap(C,"onSelection")){var B=zk.getSelectionRange(D);zkau.send({uuid:C.id,cmd:"onSelection",data:[B[0],B[1],D.value.substring(B[0],B[1])]},100)}};zkTxbox.onblur=function(A){var C=zkau.evtel(A),D=zkTxbox._noonblur(C);zkTxbox._scanStop(C);zkTxbox.updateChange(C,D);zkau.onblur(A,D);var B=$outer(C),E=getZKAttr(B,"zcls");zk.rmClass(B,E+"-focus")};zkTxbox._scanStop=function(B){var A=zkTxbox._intervals[B.id];if(A){clearInterval(A);delete zkTxbox._intervals[B.id]}if(B.removeAttribute){B.removeAttribute("zk_changing_last");B.removeAttribute("zk_changing_selbk");B.removeAttribute("zk_typeAhead")}};zkTxbox.updateChange=function(A,B){if(zkVld.validating){return true}if(A&&A.id){var C=!B?zkVld.validate(A.id):null;if(C){zkVld.errbox(A.id,C);A.setAttribute("zk_err","true");zkau.send({uuid:$uuid(A),cmd:"onError",data:[A.value,C]},-1);return false}zkVld.closeErrbox(A.id)}if(!B){zkTxbox.onupdate(A)}return true};zkTxbox._noonblur=function(B){if(zk.alerting){return true}var C=zkau.currentFocus;if(B&&C&&B!=C){var A=B;for(;;A=A.parentNode){if(!A){return false}if(getZKAttr(A,"combo")=="true"){break}if(getZKAttr(A,"type")){return false}}for(;C;C=$parent(C)){if(C==A){return true}}}return false};zkTxbox.onupdate=function(C){var D=C.value;if(D!=C.defaultValue){C.defaultValue=D;var B=$uuid(C);var A=zk.getSelectionRange(C);zkau.sendasap({uuid:B,cmd:"onChange",data:[D,false,A[0]]},zk.delayTime_onChange?zk.delayTime_onChange:150)}else{if(C.getAttribute("zk_err")){C.removeAttribute("zk_err");zkau.send({uuid:$uuid(C),cmd:"onError",data:[D,null]},-1)}}};zkTxbox.onkey=function(A){var C=Event.element(A);var B=getZKAttr(C,"maxlen");if(B){B=$int(B);if(B>0&&C.value!=C.defaultValue&&C.value.length>B){C.value=C.value.substring(0,B)}}};zkTxbox.onkeydown=function(A){var D=Event.element(A),B=$uuid(D),C=$e(B),E=Event.keyCode(A);if((E==13&&zkau.asap(C,"onOK"))||(E==27&&zkau.asap(C,"onCancel"))){zkTxbox._scanStop(D);zkTxbox.updateChange(D,false)}};zkTxbox.onfocus=function(A){var C=zkau.evtel(A),B=$outer(C);if(!$tag(C)){return }if(zkau.onfocus0(A)&&C&&C.id&&zkau.asap(B,"onChanging")){C.setAttribute("zk_changing_last",C.value);if(!zkTxbox._intervals[C.id]){zkTxbox._intervals[C.id]=setInterval("zkTxbox._scanChanging('"+C.id+"')",500)}}zk.addClass(B,getZKAttr(B,"zcls")+"-focus")};zkTxbox._scanChanging=function(C){var A=$e(C);var B=A.getAttribute("zk_typeAhead")||A.value;if(A&&zkau.asap($outer(A),"onChanging")&&A.getAttribute("zk_changing_last")!=B){zkTxbox.sendOnChanging(A,B)}};zkTxbox.sendOnChanging=function(B,C){C=C||B.value;B.setAttribute("zk_changing_last",C);var D=B.getAttribute("zk_changing_selbk");B.removeAttribute("zk_changing_selbk");var A=zk.getSelectionRange(B);zkau.send({uuid:$uuid(B),cmd:"onChanging",data:[C,D==C,A[0]],ignorable:true},100)};zkTxbox.setAttr=function(H,I,C){if("z.sel"==I){var G=$real(H);if("all"==C){zk.asyncSelect(G.id,zk.ie?150:0);return true}var B=C.split(",");var A=$int(B[0]),D=$int(B[1]),F=G.value.length;if(A<0){A=0}if(A>F){A=F}if(D<0){D=0}if(D>F){D=F}if(G.setSelectionRange){G.setSelectionRange(A,D);G.focus()}else{if(G.createTextRange){var E=G.createTextRange();if(A!=D){E.moveEnd("character",D-E.text.length);E.moveStart("character",A)}else{E.move("character",A)}E.select()}}return true}return false};zkInbox={};zkLnbox={};zkDcbox={};zkDbbox={};zkInpEl={};zkInpEl.baseChars="+0123456789"+zk.MINUS+zk.PERCENT+zk.GROUPING;zkInpEl.ignoreKeys=function(A,C){var B=Event.keyCode(A);if(!zk.ie&&(Event.isSpecialKey(A)||B==8||B==46)){return }var D=Event.charCode(A);if(C.indexOf(String.fromCharCode(D))===-1){Event.stop(A)}};zkInbox.init=zkLnbox.init=function(A){zk.listen(A,"keypress",zkInbox.onkeypress);zkTxbox.init(A)};zkInbox.onkeypress=function(A){zkInpEl.ignoreKeys(A,zkInpEl.baseChars)};zkDcbox.init=zkDbbox.init=function(A){zk.listen(A,"keypress",zkDcbox.onkeypress);zkTxbox.init(A)};zkDcbox.onkeypress=function(A){zkInpEl.ignoreKeys(A,zkInpEl.baseChars+zk.DECIMAL)};zkInbox.setAttr=zkLnbox.setAttr=zkDcbox.setAttr=zkDbbox.setAttr=zkTxbox.setAttr;zkInbox.onHide=zkLnbox.onHide=zkDcbox.onHide=zkDbbox.onHide=zkTxbox.onHide;zkInbox.cleanup=zkLnbox.cleanup=zkDcbox.cleanup=zkDbbox.cleanup=zkTxbox.cleanup;zkInbox.validate=function(A){return zkVld.onlyInt(A.id)};zkLnbox.validate=function(A){return zkVld.onlyLong(A.id)};zkDcbox.validate=function(A){return zkVld.onlyNum(A.id)};zkDbbox.validate=function(A){return zkVld.onlyNum(A.id)};