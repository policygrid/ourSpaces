zk.load("zul.vd");if(!window.Comboitem_effect){window.Comboitem_effect=function(B,A){var C=getZKAttr(B,"zcls");if(A){zk.rmClass(B,C+"-over-seld");zk.rmClass(B,C+"-over")}else{zk.addClass(B,zk.hasClass(B,C+"-seld")?C+"-over-seld":C+"-over")}}}zkCmbox={};zkCmbox.onblur=function(J){var G=zkau.evtel(J),A=$uuid(G),H=$e(A);if(!zkTxbox._noonblur(G)&&$type(H)=="Cmbox"){var F=G.value.toLowerCase();if(F.length>0){var B=$e(A+"!cave"),M=B.rows,K=-1,I=(getZKAttr(H,"valid")||"").toLowerCase().indexOf("strict")>=0;for(var C=0,E=M.length;C<E;++C){var L=M[C];var D=zkCmbox.getLabel(L).toLowerCase();if(zk.isVisible(L)&&(!I||!getZKAttr(L,"disd"))&&D==F){K=C;break}}if(K>=0){L=M[C]}else{L={id:""}}if((K>=0||!I)&&getZKAttr(H,"selid")!=L.id){setZKAttr(H,"selid",L.id);zkau.sendasap({uuid:A,cmd:"onSelect",data:[L.id,L.id]})}}}zkTxbox.onblur(J)};zkCmbox.init=function(D){zkCmbox.onVisi=zkCmbox.onSize=zul.onFixDropBtn;zkCmbox.onHide=zkTxbox.onHide;var C=$real(D);zkTxbox.init(C,null,zkCmbox.onblur);zk.listen(C,"keydown",zkCmbox.onkey);zk.listen(C,"click",function(E){if(C.readOnly&&!zk.dragging){zkCmbox.onbutton(D,E)}});var A=$e(D.id+"!pp");if(A){zk.listen(A,"click",zkCmbox.closepp)}var B=$e(D.id+"!btn");if(B){zk.listen(B,"click",function(E){if(!C.disabled&&!zk.dragging){zkCmbox.onbutton(D,E)}});zk.listen(B,"mouseover",zul.ondropbtnover);zk.listen(B,"mousedown",zul.ondropbtndown);zk.listen(B,"mouseout",zul.ondropbtnout)}};zkCmbox.cleanup=function(B){zkTxbox.cleanup(B);var A=$e(B.id+"!pp");if(A&&A._shadow){A._shadow.cleanup();A._shadow=null}};zkCmbox.strict=function(H){var E=$real($e(H));if(E&&E.value){var B=$e(H+"!cave"),F=B.rows;if(B&&B.rows){for(var C=0,G=F.length;C<G;++C){var D=F[C];if(!zk.isVisible(D)||getZKAttr(D,"disd")){continue}var A=zkCmbox.getLabel(D);if(A.toLowerCase()==E.value.toLowerCase()){E.value=A;return null}}}return mesg.VALUE_NOT_MATCHED}return null};zkCmit={};zkCmit.init=function(A){if(!getZKAttr(A,"disd")){zk.listen(A,"click",zkCmit.onclick);zk.listen(A,"mouseover",zkCmit.onover);zk.listen(A,"mouseout",zkCmit.onout)}};zkCmit.onclick=function(B){if(!B){B=window.event}var F=$parentByTag(Event.element(B),"TR");if(F){zkCmbox._selback(F);zkau.closeFloats($outer($parent(F)));zkCmit.onoutTo(F);var E=zkCmbox.getInputByItem(F);var C=$uuid(E);var D=$e(C);var A=getZKAttr(D,"selid");if(A!=F.id){setZKAttr(D,"selid",F.id);zkau.sendasap({uuid:C,cmd:"onSelect",data:[F.id,F.id]})}if(E){zkTxbox.updateChange(E,false)}Event.stop(B)}};zkCmit.onover=function(A){if(!zk.dragging){if(!A){A=window.event}var B=$parentByTag(Event.element(A),"TR");if(B){Comboitem_effect(B)}}};zkCmit.onout=function(A){if(!zk.dragging){if(!A){A=window.event}zkCmit.onoutTo($parentByTag(Event.element(A),"TR"))}};zkCmit.onoutTo=function(A){if(A){Comboitem_effect(A,true)}};zkCmbox.setAttr=function(F,B,H){if(B=="repos"){var C=$e(F.id+"!pp");if(C){C.removeAttribute("zk_ckval");if($visible(C)){zkCmbox._open(F,F.id,C,true)}}return true}else{if("style"==B){var E=$real(F);if(E){zkau.setAttr(E,B,zk.getTextStyle(H,true,true))}}else{if("style.width"==B){var E=$real(F);if(E){E.style.width=H;return true}}else{if("style.height"==B){var E=$real(F);if(E){E.style.height=H;return true}}else{if("z.btnVisi"==B){var D=$e(F.id+"!btn");if(D){D.style.display=H=="true"?"":"none"}zul.onFixDropBtn(F);return true}else{if("z.sel"==B){return zkTxbox.setAttr(F,B,H)}else{if("value"==B){var G=getZKAttr(F,"selid");if(G){var A=zkCmbox.getLabel($e(G))||"";if(A.toLowerCase()!=H.toLowerCase()){rmZKAttr(F,"selid")}}}}}}}}}return false};zkCmbox.rmAttr=function(C,A){if("style"==A){var B=$real(C);if(B){zkau.rmAttr(B,A)}}else{if("style.width"==A){var B=$real(C);if(B){B.style.width=""}}else{if("style.height"==A){var B=$real(C);if(B){B.style.height=""}}}}zkau.rmAttr(C,A);return true};zkCmbox.childchg=function(B){var C=$e(B.id+"!pp");if(!$visible(C)){return }var D=zkCmbox._ppofs(C);if(D[0]=="auto"){var A=$e(B.id+"!cave");if(zk.ie){if(A){A.style.width=""}C.style.width="";setTimeout("zkCmbox._cc2('"+B.id+"')",0)}else{zkCmbox._fixsz(B,C,A,D)}}};zkCmbox._cc2=function(C){var A=$e(C);var B=$e(C+"!pp");if($visible(B)){zkCmbox._fixsz(A,B,$e(A.id+"!cave"),zkCmbox._ppofs(B))}};zkCmbox.ondown=function(C){var A=Event.keyCode(C);if(A==38||A==40){Event.stop(C);return false}if(A==9){var E=Event.element(C);if(E){var D=$uuid(E.id);var B=$e(D+"!pp");if($visible(B)){zkCmbox.close(B)}}}return true};zkCmbox.onkey=function(K){var I=Event.element(K);if(!I){return true}I.removeAttribute("zk_typeAhead");var A=$uuid(I.id),E=$e(A),C=$e(A+"!pp");if(!C){return true}var H=Event.keyCode(K);var G=$visible(C);if(H==9||(zk.safari&&H==0)){if(G){zkCmbox.close(C)}return true}if(K.altKey&&(H==38||H==40)){if(H==38){if(G){zkCmbox.close(C)}}else{if(!G){zkCmbox.open(C,true)}}if(zk.ie){Event.stop(K);return false}return true}if(G&&H==13){var L=zkCmbox._autoselback(A);var J=$e(A),F=getZKAttr(J,"selid");if(L&&F!=L.id){setZKAttr(J,"selid",L.id);zkau.sendasap({uuid:A,cmd:"onSelect",data:[L.id,L.id]})}zkTxbox.updateChange(I,false);return true}if(H==18||H==27||H==13||(H>=112&&H<=123)){return true}var B=$type(E)=="Cmbox";var D=H==38||H==40;if(getZKAttr(E,"adr")=="true"&&!G){zkCmbox.open(C,B&&!D);zkCmbox._hiliteLater(A,K)}else{if(!B){return true}else{if(!D){zkCmbox._hiliteLater(A,K)}}}if(D){setTimeout("zkCmbox._hilite('"+A+"',true,"+(H==38)+", "+((!K.shiftKey||H!=16)&&!K.ctrlKey&&H!=8&&H!=46)+", "+H+")",3);Event.stop(K);return false}return true};zkCmbox._hiliteLater=function(C,B){var A=Event.keyCode(B);setTimeout("zkCmbox._hilite('"+C+"', false, false,"+((!B.shiftKey||A!=16)&&!B.ctrlKey&&A!=8&&A!=46)+", "+A+")",1)};zkCmbox.onbutton=function(C,B){var A=$e(C.id+"!pp");if(A){if(!$visible(A)){zkCmbox.open(A,true)}else{zkCmbox.close(A,true)}if(!B){B=window.event}Event.stop(B)}};zkCmbox.dropdn=function(B,C){var A=$e(B.id+"!pp");if(A){if("true"==C){zkCmbox.open(A,true)}else{zkCmbox.close(A,true)}}};zkCmbox._setsel=function(A,B){zk.addClass(A,getZKAttr(A,"zcls")+"-seld",B)};zkCmbox.getLabel=function(A){return A&&A.cells&&A.cells.length>1&&A.cells[1].firstChild&&A.cells[1].firstChild.data?A.cells[1].firstChild.data:""};zkCmbox.open=function(B,C){B=$e(B);var D=$uuid(B.id);var A=$e(D);if(!A){return }zkau.closeFloats(B);zkCmbox._pop.addFloatId(B.id,$type(A)!="Cmbox");zkCmbox._open(A,D,B,C);if(zkau.asap(A,"onOpen")){zkau.send({uuid:D,cmd:"onOpen",data:[true,null,$e(D+"!real").value]})}};zkCmbox._open=function(B,F,C,E){var D=zkCmbox._ppofs(C);C.style.width=D[0];C.style.height="auto";var A=$e(F+"!cave");if(A){A.style.width=A.style.height="auto"}C.style.position="absolute";C.style.display="block";C.style.zIndex="88000";zk.addClass(C,"z-hidden-offset");zk.onVisiAt(C);zk.setVParent(C);zk.rmClass(C,"z-hidden-offset");zkCmbox._fixsz(B,C,A,D);zk.position(C,$real(B),"after-start");setTimeout("zkCmbox._repos('"+F+"',"+E+")",3)};zkCmbox._ppofs=function(B){for(var D=B.firstChild;D;D=D.nextSibling){if(D.id){if(!D.id.endsWith("!cave")){var A=D.style.width,C=D.style.height;return[A?A:"auto",C?C:"auto"]}break}}return["auto","auto"]};zkCmbox._fixsz=function(B,C,A,D){if(D[1]=="auto"&&C.offsetHeight>250){C.style.height="250px"}else{if(C.offsetHeight<10){C.style.height="10px"}}if(D[0]=="auto"){if(C.offsetWidth<B.offsetWidth){C.style.width=B.offsetWidth+"px";if(A){A.style.width="100%"}}else{var E=zk.innerWidth()-20;if(E<B.offsetWidth){E=B.offsetWidth}if(C.offsetWidth>E){C.style.width=E}}}};zkCmbox._repos=function(A,H){var E=$e(A);if(!E){return }var B=$e(A+"!pp");var C=$e(A+"!cave");var J=E.id+"!real";var G=$e(J);var K=C?C.rows:null;if(K){var I=B.offsetHeight-B.clientHeight;if(I>10&&B.offsetHeight<150){var D=0;for(var F=K.length;--F>=0;){D+=K[F].offsetHeight}B.style.height=(D+20)+"px"}}zk.position(B,G,"after-start");zkau.hideCovered();zk.asyncFocus(J);if(!B._shadow){B._shadow=new zk.Shadow(B,{autoShow:true})}else{B._shadow.sync()}if(H){zkCmbox._hilite(A)}};zkCmbox._selback=function(C){var A=zkCmbox.getLabel(C);var B=zkCmbox.getInputByItem(C);if(B){B.value=A;B.setAttribute("zk_changing_selbk",A);zk.asyncFocus(B.id);zk.asyncSelect(B.id)}};zkCmbox._autoselback=function(C){var A=$e(C+"!cave");if(!A){return }var E=A.rows;if(!E){return }for(var B=E.length;--B>=0;){var D=E[B];if(D.getAttribute("zk_hilite")=="true"){zkCmbox._selback(D);return D}}};zkCmbox.getInputByItem=function(B){var A=$uuid(B.parentNode);if(!A){return null}var C=A+"!real";return $e(C)};zkCmbox._hilite=function(uuid,selback,bUp,reminder,keycode){var inp=$e(uuid+"!real");if(!inp){return }var pp=$e(uuid+"!pp");if(!pp
/*aco &&*/
){return }var pp2=$e(uuid+"!cave");if(!pp2){return }var rows=pp2.rows;if(!rows){return }var inpval=inp.value.toLowerCase(),ckval=pp.getAttribute("zk_ckval");if(!selback&&ckval==inpval&&ckval==inp.getAttribute("zk_changing_last")){return }var jfnd=-1,exact=!inpval,old;for(var j=0,rl=rows.length;j<rl;++j){var item=rows[j];if(!zk.isVisible(item)){continue}if(!exact){var txt=zkCmbox.getLabel(item).toLowerCase();if(txt==inpval){exact=true;jfnd=j}else{if(jfnd<0&&txt.startsWith(inpval)){jfnd=j}}}if(item.getAttribute("zk_hilite")=="true"){if(old){zkCmbox._setsel(item,false);item.removeAttribute("zk_hilite")}else{old=item}}}var found;if(selback){if(jfnd<0){if(rows.length){found=rows[zkCmbox._next(rows,0)]}}else{if(exact){var b=document.selection;if((b&&"Text"==b.type&&document.selection.createRange().text.toLowerCase()==inpval)||(!b&&inpval.length&&inp.selectionStart==0&&inp.selectionEnd==inpval.length)){jfnd=zkCmbox[bUp?"_prev":"_next"](rows,jfnd,true)}}else{if(bUp){jfnd=zkCmbox._prev(rows,jfnd);if(zkCmbox.disabled(rows[jfnd])){jfnd=zkCmbox._next(rows,jfnd)}}else{jfnd=zkCmbox._next(rows,jfnd);if(zkCmbox.disabled(rows[jfnd])){jfnd=zkCmbox._prev(rows,jfnd)}}}if(jfnd>=0){found=rows[jfnd]}}if(found){zkCmbox._selback(found);var cmp=$e(uuid);var selId=getZKAttr(cmp,"selid");if(selId!=found.id){setZKAttr(cmp,"selid",found.id);zkau.sendasap({uuid:uuid,cmd:"onSelect",data:[found.id,found.id]})}}}else{if(jfnd>=0){found=getZKAttr(rows[jfnd],"disd")?null:rows[jfnd]}}if(old!=found){if(old){zkCmbox._setsel(old,false);old.removeAttribute("zk_hilite")}if(found){zkCmbox._setsel(found,true);found.setAttribute("zk_hilite","true");inpval=zkCmbox.getLabel(found)}}if(reminder){inp.setAttribute("zk_typeAhead",inp.value);if(found){var c=zkCmbox.getLabel(found);var start=inp.value.length,end=c.length,strict=getZKAttr($e(uuid),"valid")||"";inp.value=strict.toLowerCase().indexOf("strict")>-1?c:inp.value+(start<end?c.substring(start):"");if(inp.setSelectionRange){inp.setSelectionRange(start,end);inp.focus()}else{if(inp.createTextRange){var range=inp.createTextRange();if(start!=end){range.moveEnd("character",end-range.text.length);range.moveStart("character",start)}else{range.move("character",start)}range.select()}}}}else{if(keycode&&(keycode==8||keycode==46)){inp.setAttribute("zk_typeAhead",inp.value)}}zk.scrollIntoView(pp,found);pp.setAttribute("zk_ckval",inpval)};zkCmbox._prev=function(D,A,C){for(var B=A-(C?1:0);B>=0;B--){if(!zkCmbox.disabled(D[B])){return B}}return A};zkCmbox._next=function(D,A,C){for(var B=A+(C?1:0),E=D.length;B<E;B++){if(!zkCmbox.disabled(D[B])){return B}}return A};zkCmbox.disabled=function(A){return !A||!zk.isVisible(A)||getZKAttr(A,"disd")};zkCmbox.cbclose=function(A){zkCmbox.close(A.id+"!pp",true)};zkCmbox.close=function(C,B){C=$e(C);var E=$uuid(C.id);C.style.display="none";zk.unsetVParent(C);zkCmbox._pop.removeFloatId(C.id);zk.onHideAt(C);zkau.hideCovered();if(B){zk.asyncFocus(E+"!real")}if(C._shadow){C._shadow.hide()}var A=$e(E),D=$e(E,"btn"),F=getZKAttr(A,"zcls");if(D){zk.rmClass(D,F+"-btn-over")}if(A&&zkau.asap(A,"onOpen")){zkau.send({uuid:E,cmd:"onOpen",data:[false,null,$e(E+"!real").value]})}};zkCmbox.closepp=function(B){if(!B){B=window.event}var A=Event.element(B);for(;A;A=A.parentNode){if(A.id){if(A.id.endsWith("!pp")){zkCmbox.close(A,true)}return }if(A.onclick){return }}};zk.FloatCombo=zClass.create();Object.extend(Object.extend(zk.FloatCombo.prototype,zk.Floats.prototype),{_close:function(A){zkCmbox.close(A)}});if(!zkCmbox._pop){zkau.floats.push(zkCmbox._pop=new zk.FloatCombo())}zkBdbox=zkCmbox;