zk.FloatMenu=zClass.create();Object.extend(Object.extend(zk.FloatMenu.prototype,zk.Floats.prototype),{_close:function(A){zkMenu2._close(A)}});zkMenu2={init:function(B){var C=$e(B.id+"!a");if(zkMenu2.isTop(B)){zk.listen(C,"click",zkMenu2.onclick);zk.listen(C,"mouseover",zkMenu2.onover);zk.listen(C,"mouseout",zkMenu2.onout)}else{zk.listen(B,"click",zkMenu2.onclick);zk.listen(B,"mouseover",zkMenu2.onover);zk.listen(B,"mouseout",zkMenu2.onout);zk.listen(C,"focus",zkau.onfocus);zk.listen(C,"blur",zkau.onblur)}var A=$e(getZKAttr(B,"mpop"));if(A){zk.listen(A,"keydown",zkMenu2.onkeydown)}zkMenu2.fixBtn(B)},indexOf:function(A){for(var C=A.parentNode.firstChild,B=0;C;C=C.nextSibling){if(C==A){return B}if(zkMenu2.isItemActive(C)){B++}}return -1},isItemActive:function(A){return A&&A.nodeType==1&&$type(A)!="Menusp2"&&!getZKAttr(A,"disd")},onPopupOut:function(A){if(A){zk.rmClass(A,getZKAttr(A,"zcls")+"-over")}},onPopupOver:function(D,B){var A=D.parentNode.parentNode;var C=getZKAttr(A,"seld");if(C||C===0){zkMenu2.onPopupOut(zkMenu2.getItemAt(D.parentNode,$int(C)).el)}setZKAttr(A,"seld",B===undefined?zkMenu2.indexOf(D):B);zk.addClass(D,getZKAttr(D,"zcls")+"-over")},getItemAt:function(C,B){for(var D=C.firstChild,A=-1;D;D=D.nextSibling){if(zkMenu2.isItemActive(D)&&++A===B){return{el:D,index:A}}}return{}},isTop:function(A){return A&&getZKAttr(A,"top")=="true"},fixBtn:zk.ie?function(B){if(zkMenu2.isTop(B)){var A=$e(B.id+"!b");if(!A||!A.innerHTML.trim()){return }A.style.width=zk.TextUtil.measure(A).width+zk.getFrameWidth(A)+"px"}}:zk.voidf,cleanup:function(B){var A=$e(getZKAttr(B,"mpop"));if(A&&A._shadow){A._shadow.cleanup();A._shadow=null}},onkeydown:function(B){if(!B){B=window.event}var D=$outer(Event.element(B));if(!D){return }var C=$e(D.id+"!cave"),A=getZKAttr(D,"seld");zkMenu2.navigate(C,Event.keyCode(B),A?$int(A):A);Event.stop(B);return false},navigate:function(D,A,C){var E=C||C===0?zkMenu2.getItemAt(D,C):{};switch(A){case 38:if(E.el){for(E.el=E.el.previousSibling;E.el;E.el=E.el.previousSibling){if(zkMenu2.isItemActive(E.el)){E.index--;break}}}if(!E.el){for(var H=D.lastChild;H;H=H.previousSibling){if(zkMenu2.isItemActive(H)){E.el=H;break}}E.index=-1;for(var H=D.firstChild;H;H=H.nextSibling){if(zkMenu2.isItemActive(H)){E.index++}}}zkMenu2.onPopupOver(E.el,E.index);return true;case 40:if(E.el){for(E.el=E.el.nextSibling;E.el;E.el=E.el.nextSibling){if(zkMenu2.isItemActive(E.el)){E.index++;break}}}if(!E.el){for(var H=D.firstChild;H;H=H.nextSibling){if(zkMenu2.isItemActive(H)){E.el=H;break}}E.index=0}zkMenu2.onPopupOver(E.el,E.index);return true;case 37:var B=$outer(D);if(B){zkMenu2.close(B);var G=$e(getZKAttr(B,"menuId"));if(G&&!zkMenu2.isTop(G)){B=G.parentNode.parentNode;if(B){var F=$e(B.id+"!a");if(F){F.focus()}}}}return true;case 39:if(E.el&&"Menu2"==$type(E.el)){zkMenu2.open(E.el)}return true;case 13:if(E.el&&"Menuit2"==$type(E.el)){zkMenuit2._onclick(E.el)}return true}},onover:function(D){if(!D){D=window.event}var F=$outer(Event.element(D));if($type(F)!="Menusp2"){if(zkMenu2.isTop(F)){zk.addClass($e(F.id+"!a"),getZKAttr(F,"zcls")+"-btn-over")}else{zkMenu2.onPopupOver(F)}}var G=$parentByType(F,"Menubar2");var C=!G||getZKAttr(G,"autodrop")=="true";if(C){zkMenu2._shallClose=false}var B=zkMenu2._pop.getFloatIds();if(!C&&B.length==0){return }for(var E=B.length;--E>=0;){var A=$e(B[E]);if(!zk.isAncestor(F,A)&&!zk.isAncestor(A,F)){zkMenu2.close(A)}}zkMenu2.open(F,false)},onout:function(A){if(!A){A=window.event}var B=$outer(Event.element(A));if(!zk.ie||zkMenu2.isTop(B)||zkMenu2._shouldDeactivate(B,A)){zkMenu2._onout(B)}},_shouldDeactivate:function(C,B){var D=zk.revisedOffset(C),A=Event.pointerX(B),E=Event.pointerY(B);return !(A>=D[0]&&A<=D[0]+C.offsetWidth&&E>=D[1]&&E<=D[1]+C.offsetHeight)},_onout:function(A,C){if($type(A)!="Menusp2"){if(zkMenu2.isTop(A)){zk.rmClass($e(A.id+"!a"),getZKAttr(A,"zcls")+"-btn-over")}else{zkMenu2.onPopupOut(A)}}if(!C&&zkMenu2._pop.getFloatIds().length!=0){var B=$parentByType(A,"Menubar2");if(B&&getZKAttr(B,"autodrop")=="true"){zkMenu2._shallClose=true;setTimeout("if (zkMenu2._shallClose) zkau.closeFloatsOf('"+B.id+"');",500)}}},onclick:function(A){if(!A){A=window.event}var B=$outer(Event.element(A));if($type(B)!="Menusp2"){zk.addClass($e(B.id+"!a"),getZKAttr(B,"zcls")+"-btn-seld")}if("Menu2"==$type(B)){zkMenu2.open(B,zkMenu2.isTop(B))}},open:function(E,A){if(A){zkau.closeFloats(E)}var C=getZKAttr(E,"mpop");if(!C){if($type(E)!="Menusp2"){zk.rmClass($e(E.id+"!a"),getZKAttr(E,"zcls")+"-btn-seld")}return }var B=$e(C);if(!B){zk.error(mesg.INVALID_STRUCTURE+"z.mpop not exists");return }setZKAttr(B,"menuId",E.id);if(!$visible(B)){var D=zkMenu2.isTop(E),F=D&&getZKAttr(E,"vert")==null?"after-start":"end_before";B.style.position="absolute";zk.setVParent(B);zkMenu2._open(B,D,$e(E,"a"),F);if(zkau.asap(B,"onOpen")){zkau.send({uuid:B.id,cmd:"onOpen",data:[true,E.id]})}}},_open:function(A,E,C,F){if(C){zk.position(A,C,F)}zk.show(A);if(zk.ie7&&!A.style.width){var B=$e(A.id+"!cave");A.style.width=B.offsetWidth+zk.getFrameWidth(A)+"px"}if(!A._shadow){A._shadow=new zk.Shadow(A,{mode:"drop",autoShow:true})}else{A._shadow.sync()}zkMenu2._pop.addFloatId(A.id);zkau.hideCovered();var D=$e(A.id+"!a");if(D){D.focus()}},close:function(A){zkMenu2._pop.removeFloatId(A.id);zkMenu2._close(A);zkau.hideCovered()},_close:function(A){A=$e(A);if(A){if(A._shadow){A._shadow.hide()}A.style.display="none";zk.unsetVParent(A);rmZKAttr(A,"owner");var C=$e(getZKAttr(A,"menuId"));if(zkMenu2.isTop(C)){zk.rmClass($e(C.id+"!a"),getZKAttr(C,"zcls")+"-btn-seld")}if(zkau.asap(A,"onOpen")){zkau.send({uuid:A.id,cmd:"onOpen",data:[false]})}var B=getZKAttr(A,"seld");if(B||B===0){zkMenu2.onPopupOut(zkMenu2.getItemAt($e(A.id+"!cave"),$int(B)).el);rmZKAttr(A,"seld")}zk.fire(A,"close")}}};if(!zkMenu2._pop){zkau.floats.push(zkMenu2._pop=new zk.FloatMenu())}zkMenuit2={fixBtn:zkMenu2.fixBtn,init:function(A){if(!getZKAttr(A,"disd")){zk.listen(A,"click",zkMenuit2.onclick);zk.listen(A,"mouseover",zkMenu2.onover);zk.listen(A,"mouseout",zkMenu2.onout);if(zkMenu2.isTop(A)){var C=$e(A.id+"!a");zk.listen(C,"focus",zkau.onfocus);zk.listen(C,"blur",zkau.onblur)}}else{var B=$parentByType(A,"Menubar");if(!B||getZKAttr(B,"autodrop")=="true"){zk.listen(A,"mouseover",zkMenuit2.onover);zk.listen(A,"mouseout",zkMenu2.onout)}zk.listen($e(A.id+"!a"),"click",Event.stop)}zkMenuit2.fixBtn(A)},onover:function(A){zkMenu2._shallClose=false},onclick:function(A){if(!A){A=window.event}var B=Event.element(A);zkMenuit2._onclick(B)},_onclick:function(D){D=$parentByType(D,"Menuit2");zkMenu2._onout(D,true);var F=$e(D.id+"!a");if(zkMenu2.isTop(D)){F=F.parentNode}if("javascript:;"==F.href){var D=$outer(F);var C=D.id;if(getZKAttr(D,"autock")){var E=getZKAttr(D,"checked")!="true";zkau.send({uuid:C,cmd:"onCheck",data:[E]},-1)}zkau.send({uuid:C,cmd:"onClick",ctl:true})}else{var B=F.getAttribute("target");var A=false;if(F.href&&!zk.isNewWindow(F.href,B)){zk.progress();A=true}if(D.id!=F.id){zk.go(F.href,A,B)}}if(!getZKAttr(D,"pop")){zkau.closeFloats(D)}}};zkMenusp2={init:function(A){zk.listen(A,"mouseover",zkMenu2.onover);zk.listen(A,"mouseout",zkMenu2.onout)}};zkMpop2={context:function(A,B){if(!$visible(A)){zkMenu2._open(A,true);if(zkau.asap(A,"onOpen")){zkau.send({uuid:A.id,cmd:"onOpen",data:B?[true,B.id]:[true]})}}else{if(A._shadow){A._shadow.sync()}}}};