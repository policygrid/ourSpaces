zk.load("zul.vd");zkSpinner={};zkSpinner.init=function(C){zkSpinner.onVisi=zkSpinner.onSize=zul.fixDropBtn2;zkSpinner.onHide=zkTxbox.onHide;zkSpinner.validate=zkInbox.validate;zkTxbox.init($real(C));C.runCount=0;C.timerId=null;C.step=parseInt(getZKAttr(C,"step"));C.min=parseInt(getZKAttr(C,"min"));C.max=parseInt(getZKAttr(C,"max"));var B=$real(C);var A=$e(C.id+"!btn");zk.listen(B,"keypress",zkSpinner.onkeypress);zk.listen(B,"keydown",zkSpinner._inpkeydown);if(A){zk.listen(A,"mousedown",zkSpinner._btnDown);zk.listen(A,"mouseup",zkSpinner._btnUp);zk.listen(A,"mouseout",zkSpinner._btnOut);zk.listen(A,"mouseover",zul.ondropbtnover)}};zkSpinner.cleanup=function(A){if(A.timerId){clearTimeout(A.timerId);A.timerId=null}zkTxbox.cleanup(A)};zkSpinner.setAttr=function(D,A,E){if("value"==A){if(E){var C=$real(D);C.value=E}else{zkSpinner._clearValue(D)}return true}else{if("z.step"==A){D.step=parseInt(E);return true}else{if("z.min"==A){D.min=parseInt(E);return true}else{if("z.max"==A){D.max=parseInt(E);return true}else{if("z.btnVisi"==A){var B=$e(D.id+"!btn");if(B){B.style.display=E=="true"?"":"none"}zul.fixDropBtn2(D);return true}else{if("style"==A){var C=$real(D);if(C){zkau.setAttr(C,A,zk.getTextStyle(E,true,true))}}else{if("style.width"==A){var C=$real(D);if(C){C.style.width=E;return true}}else{if("style.height"==A){var C=$real(D);if(C){C.style.height=E;return true}}}}}}}}}zkau.setAttr(D,A,E);return true};zkSpinner.rmAttr=function(C,A){if("style"==A){var B=$real(C);if(B){zkau.rmAttr(B,A)}}else{if("style.width"==A){var B=$real(C);if(B){B.style.width=""}}else{if("style.height"==A){var B=$real(C);if(B){B.style.height=""}}}}zkau.rmAttr(C,A);return true};zkSpinner.onkeypress=function(A){zkInpEl.ignoreKeys(A,"0123456789"+zk.MINUS)};zkSpinner._inpkeydown=function(A){if(!A){A=window.event}var D=Event.element(A),C=$outer(D);if(D.disabled||D.readOnly){return }var B=Event.keyCode(A);switch(B){case 38:zkSpinner.checkValue(C);zkSpinner._increase(C,true);Event.stop(A);break;case 40:zkSpinner.checkValue(C);zkSpinner._increase(C,false);Event.stop(A);break}};zkSpinner.checkValue=function(A){inp=$real(A);if(!inp.value){if(A.min&&A.max){inp.value=(A.min<=0&&0<=A.max)?0:A.min}else{if(A.min){inp.value=A.min<=0?0:A.min}else{if(A.max){inp.value=0<=A.max?0:A.max}else{inp.value=0}}}}};zkSpinner._btnDown=function(A){if(!A){A=window.event}zul.ondropbtndown(A);var D=$outer(Event.element(A)),C=$real(D);if(C.disabled){return }zkSpinner.checkValue(D);var B=zk.opera||zk.safari?$e(D.id+"!btn"):zk.firstChild($e(D.id+"!btn"),"IMG"),E=zk.revisedOffset(B);if((Event.pointerY(A)-E[1])<B.offsetHeight/2){zkSpinner._increase(D,true);zkSpinner._startAutoIncProc(D,true)}else{zkSpinner._increase(D,false);zkSpinner._startAutoIncProc(D,false)}};zkSpinner._btnUp=function(A){if(!A){A=window.event}var C=$outer(Event.element(A));var B=$real(C);if(B.disabled){return }zkTxbox.sendOnChanging(B);zkSpinner._stopAutoIncProc(C);B.focus()};zkSpinner._btnOut=function(A){if(!A){A=window.event}zul.ondropbtnout(A);var C=$outer(Event.element(A));var B=$real(C);if(B.disabled){return }zkSpinner._stopAutoIncProc(C)};zkSpinner._increase=function(C,A){var B=$real(C);var D=parseInt(B.value);if(A){result=D+C.step}else{result=D-C.step}if(result>Math.pow(2,31)-1){result=Math.pow(2,31)-1}else{if(result<-Math.pow(2,31)){result=-Math.pow(2,31)}}if(C.max!=null&&result>C.max){result=C.max}else{if(C.min!=null&&result<C.min){result=C.min}}B.value=result;zkTxbox.sendOnChanging(B)};zkSpinner._clearValue=function(A){var B=$real(A);B.value=B.defaultValue="";return true};zkSpinner._startAutoIncProc=function(B,A){if(B.timerId){clearInterval(B.timerId)}B.timerId=setInterval(function(){zkSpinner._increase(B,A)},500)};zkSpinner._stopAutoIncProc=function(A){if(A.timerId){clearTimeout(A.timerId)}A.timerId=null};