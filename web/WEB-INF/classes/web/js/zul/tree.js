zk.load("zul.sel");function zkTreeNewClass(){if(zk.Tree){return }zk.Tree=zClass.create();Object.extend(Object.extend(zk.Tree.prototype,zk.Selectable.prototype),{getItemUuid:function(A){return getZKAttr(A,"pitem")},_isRowType:function(A){return $type(A)=="Trow"},_doLeft:function(A){if(zkTree.isOpen(A)){this._openItem(A,null,false)}},_doRight:function(A){if(!zkTree.isOpen(A)){this._openItem(A,null,true)}},toggleOpen:function(A,D){var E=zk.parentNode(D,"TR");if(!E){return }this._syncFocus(E);var B=!zkTree.isOpen(E);this._openItem(E,D,B);var C=$e(C+"!cm");if(!C&&!this._focusItem){this._focusItem=E}if(C||(C=$e(getZKAttr(E,"rid"),"a"))){zk.asyncFocus(C.id)}Event.stop(A)},_openItem:function(C,B,A){if(!B){B=$e(C.id+"!open");if(!B){return }}B.className=zk.renType(B.className,A?"open":"close");setZKAttr(C,"open",A?"true":"false");this._showKids(C,A);if(A&&this.realsize()==0){this._calcSize()}zkau.send({uuid:getZKAttr(C,"pitem"),cmd:"onOpen",data:[A]},A&&getZKAttr(C,"lod")?38:zkau.asapTimeout(C,"onOpen"))},_showKids:function(F,C,B){var D=getZKAttr(F,"pitem");do{var E=F.nextSibling;if($tag(E)=="TR"){var A=getZKAttr(E,"gpitem");if(!D||D!=A){return F}if(!B&&(E.id.indexOf("!")>-1||getZKAttr(E,"visible")=="true")){E.style.display=C?"":"none"}E=this._showKids(E,C,C&&(B||!zkTree.isOpen(E)))}}while(F=E)},stripe:function(){}})}zkTree={};zkTree.init=function(A){var B=zkau.getMeta(A);if(B){B.init()}else{zkTreeNewClass();B=new zk.Tree(A);if(B.body){zk.listen(B.body,"keydown",zkTree.bodyonkeydown)}}};zkTree.childchg=zkTree.onVisi=zkTree.onSize=function(A){var B=zkau.getMeta(A);if(B){B._recalcSize()}};zkTree.beforeSize=function(A){var B=zkau.getMeta(A);if(B){B._beforeSize()}};zkTree.bodyonkeydown=function(A){if(!A){A=window.event}var C=Event.element(A);var B=zkau.getMetaByType(C,"Tree");return !B||B.dobodykeydown(A,C)};zkTree.onkeydown=function(A){if(!A){A=window.event}var C=Event.element(A);var B=zkau.getMetaByType(C,"Tree");return !B||B.dokeydown(A,C)};zkTree.onclick=function(A){if(!A){A=window.event}var C=Event.element(A);var B=zkau.getMetaByType(C,"Tree");if(B){B.doclick(A,C)}};zkTree.focus=function(A){var B=zkau.getMeta(A);if(B){B._refocus()}return true};zkTree.setAttr=function(B,A,D){var C=zkau.getMeta(B);if(C){return C.setAttr(A,D)}};zkTree.ontoggle=function(A){if(!A){A=window.event}var C=Event.element(A);var B=zkau.getMetaByType(C,"Tree");if(B){B.toggleOpen(A,C)}};zkTree.isOpen=function(A){return getZKAttr(A,"open")=="true"};zkTrow={};zkTrow.init=function(B){zk.listen(B,"keydown",zkTree.onkeydown);if(!getZKAttr(B,"disd")){zk.listen(B,"click",zkTree.onclick);zk.listen(B,"mouseover",zkSel.onover);zk.listen(B,"mouseout",zkSel.onout)}_zktrx.init(B,"ptch");_zktrx.init(B,"pitem");var A=getZKAttr(B,"tchsib");if(A){_zktrx.sib[A]=B.id}};zkTrow.cleanup=zkTrow._pgclean=function(A){_zktrx.cleanup(A,"ptch");_zktrx.cleanup(A,"pitem");delete _zktrx.sib[getZKAttr(A,"tchsib")]};zkTrow.setAttr=function(C,A,E){if("z.open"==A){var B="true"==E;if(B!=zkTree.isOpen(C)){var D=zkau.getMeta(getZKAttr(C,"rid"));if(D){D._openItem(C,null,B)}}return true}return false};zkTrow.open=function(E,B){if(typeof E=="string"){var D=$e(E);E=D?D:$e(_zktrx.sib[E])}var A=getZKAttr(cmp,"rid")||$parentByType(E,"Tree");var C=zkau.getMeta(A);if(C){C._openItem(E,null,B!=false)}};zkTrow.onrtclk=function(A){var B=zkau.getMeta(getZKAttr(A,"rid"));if(B&&!B._isSelected(A)){B.doclick(null,A)}};zkTrow._lastKid=function(D){var B=getZKAttr(D,"pitem");var E=D;do{var C=E.nextSibling;if($tag(C)=="TR"){var A=getZKAttr(C,"gpitem");if(B!=A){return D}D=C=zkTrow._lastKid(C)}}while(E=C);return D};if(!zk.safari){zkTcfc={};zkTcfc.init=function(A){zk.listen(A,"focus",zkSel.cmonfocus);zk.listen(A,"blur",zkSel.cmonblur)}}zkTcop={};zkTcop.init=function(A){zk.listen(A,"click",zkTree.ontoggle)};zk.addBeforeInit(function(){zkTcol={};Object.extend(zkTcol,zulHdr);zkTcol.resize=function(E,C,A,B){var D=zkau.getMeta(getZKAttr(E.parentNode,"rid"));if(D){D.resizeCol($parentByType(E,"Tcols"),C,E,A,B)}};zkTcols=zulHdrs;zkTrow.initdrag=zkLit.initdrag;zkTrow.cleandrag=zkLit.cleandrag});var _zktrx={};_zktrx.dom={};_zktrx.sib={};_zktrx.au={};_zktrx.init=function(B,A){var C=getZKAttr(B,A);if(C){var D=_zktrx.dom[C];if(!D){D=_zktrx.dom[C]=[]}D.push(B.id);if("pitem"==A){_zktrx.sib[C]=B.id}}};_zktrx.cleanup=function(B,A){var C=getZKAttr(B,A);var D=C?_zktrx.dom[C]:null;if(D){D.remove(B.id);if(!D.length){delete _zktrx.dom[C]}if("pitem"==A){delete _zktrx.sib[C]}}};zk.override(zkau.cmd1,"outer",_zktrx.au,function(E,F,D){if(!F){var G=_zktrx.dom[E];if(G){for(var C=G.length;--C>=0;){var H=G[C];var A=$e(H);_zktrx._rmKids(A);if(C==0){E=H;F=A}else{_zktrx.au.rm(H,A)}}G.length=0}else{var B=_zktrx.sib[E];if(B){_zktrx.au.addAft(E,$e(B),D);return }}}if(F&&D.trim()){_zktrx.au.outer(E,F,D)}});zk.override(zkau.cmd1,"addAft",_zktrx.au,function(B,C,A){if(!C){C=$e(_zktrx.sib[B]);if(C){C=zkTrow._lastKid(C)}}_zktrx.au.addAft(B,C,A)});zk.override(zkau.cmd1,"addBfr",_zktrx.au,function(B,C,A){_zktrx.au.addBfr(B,C?C:$e(_zktrx.sib[B]),A)});zk.override(zkau.cmd1,"addChd",_zktrx.au,function(B,C,A){if(C){_zktrx.au.addChd(B,C,A)}else{_zktrx.au.addAft(B,$e(_zktrx.sib[B]),A)}});zk.override(zkau.cmd1,"rm",_zktrx.au,function(C,D){var E=_zktrx.dom[C];if(E){for(var B=E.length;--B>=0;){var F=E[B];var A=$e(F);_zktrx._rmKids(A);_zktrx.au.rm(F,A)}E.length=0;return }_zktrx.au.rm(C,D)});_zktrx._rmKids=function(A){var B=A?getZKAttr(A,"tchsib"):null;if(B){zkau.cmd1.rm(B,$e(B))}};